function calcContainer() {
  // 1) Read selectors
  const wUnit = document.getElementById('cbWeightUnit').value;   // "lbs","kg","us_ton","metric_ton"
  const lUnit = document.getElementById('cbLengthUnit').value;   // "ft" or "m"
  const cType = parseFloat(document.getElementById('cbContainerType').value); // e.g. 40

  // 2) Conversion helpers
  const toFeet      = v => v;                  // input in ft
  const toFeetFromM = v => v / 0.3048;         // input in m
  const toLbsFromKg = v => v * 2.20462;        // input in kg
  const toLbsFromUS = v => v * 2000;           // input in US tons
  const toLbsFromMT = v => v * 2204.62;        // input in metric tons
  const fromLbs     = (v,unit) => {
    if(unit==='kg') return (v/2.20462).toFixed(2);
    if(unit==='us_ton') return (v/2000).toFixed(2);
    if(unit==='metric_ton') return (v/2204.62).toFixed(2);
    return v.toFixed(2);                     // lbs
  };

  // 3) Desired CG
  const L = cType;         // container length in ft
  const C = L/2;           // desired center in ft

  // 4) Gather objects
  let weights = [], widths = [];
  for (let i = 1; i <= 6; i++) {
    const wRaw = parseFloat(document.getElementById(`cbLoad${i}W`).value);
    const dRaw = parseFloat(document.getElementById(`cbLoad${i}D`).value);
    if (!isNaN(wRaw) && !isNaN(dRaw)) {
      // Convert to base units (lbs, ft)
      let wLbs = wRaw;
      if (wUnit==='kg')        wLbs = toLbsFromKg(wRaw);
      else if (wUnit==='us_ton')   wLbs = toLbsFromUS(wRaw);
      else if (wUnit==='metric_ton') wLbs = toLbsFromMT(wRaw);

      let dFt = (lUnit==='m') ? toFeetFromM(dRaw) : toFeet(dRaw);

      weights.push(wLbs);
      widths.push(dFt);
    }
  }

  const n = weights.length;
  if (n === 0) {
    document.getElementById('containerResult').textContent = 'Enter at least one object.';
    return;
  }

  // 5) Compute prefix widths P_i and moment M0
  let W = 0, M0 = 0;
  const P = new Array(n).fill(0);
  for (let i = 0; i < n; i++) {
    if (i > 0) P[i] = P[i-1] + widths[i-1];
    W += weights[i];
    M0 += weights[i] * (P[i] + widths[i]/2);
  }

  // 6) Solve x1 = (W*C - M0)/W
  const x1 = (W*C - M0)/W;

  // 7) Build table
  const tbody = document.querySelector('#containerTable tbody');
  tbody.innerHTML = '';
  let cumW = 0, cumM = 0;
  for (let i = 0; i < n; i++) {
    const leftFt = x1 + P[i];
    const cgFt   = leftFt + widths[i]/2;

    // Update cumulatives
    cumW += weights[i];
    cumM += weights[i] * cgFt;

    // Convert back to display units
    const leftDisp = (lUnit==='m' ? (leftFt*0.3048).toFixed(2) : leftFt.toFixed(2));
    const cgDisp   = (lUnit==='m' ? (cgFt*0.3048).toFixed(2) : cgFt.toFixed(2));
    const wDisp    = fromLbs(weights[i], wUnit);
    const dDisp    = (lUnit==='m' ? (widths[i]*0.3048).toFixed(2) : widths[i].toFixed(2));

    const row = document.createElement('tr');
    row.innerHTML = `
      <td style="border:1px solid #ccc;padding:8px">Obj ${i+1}</td>
      <td style="border:1px solid #ccc;padding:8px">${wDisp} ${wUnit}</td>
      <td style="border:1px solid #ccc;padding:8px">${dDisp} ${lUnit}</td>
      <td style="border:1px solid #ccc;padding:8px">${cgDisp} ${lUnit}</td>
      <td style="border:1px solid #ccc;padding:8px">${leftDisp} ${lUnit}</td>
    `;
    tbody.appendChild(row);
  }

  // 8) Summary
  const overallCGFt = cumM/cumW;
  const overallCGDisp = (lUnit==='m'? (overallCGFt*0.3048).toFixed(2) : overallCGFt.toFixed(2));
  const totalLoadDisp= fromLbs(cumW, wUnit);
  document.getElementById('containerResult').innerHTML = `
    Total Load: ${totalLoadDisp} ${wUnit}<br>
    Overall CG: ${overallCGDisp} ${lUnit} from left 
    (${((overallCGFt/L)*100).toFixed(1)}% of length)
  `;
}